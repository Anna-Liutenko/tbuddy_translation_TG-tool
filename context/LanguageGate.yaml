kind: AdaptiveDialog
beginDialog:
  kind: OnActivity
  id: main
  type: Message
  actions:
    - kind: ConditionGroup
      id: conditionGroup_M7BDy9
      conditions:
        - id: conditionItem_Jg0641
          condition: =IsBlank(Global.setupComplete)
          actions:
            - kind: SetVariable
              id: setVariable_OEmu4u
              variable: Global.setupComplete
              value: in process

            - kind: BeginDialog
              id: sHd2yw
              dialog: cr268_tBuddy.topic.startLanguageSetupEvent

      elseActions:
        - kind: ConditionGroup
          id: conditionGroup_MASTER_CONDITION
          conditions:
            - id: conditionItem_SETUP_COMPLETE
              condition: =Global.setupComplete = "complete"
              actions:
                - kind: InvokeAIBuilderModelAction
                  id: invokeAIBuilderModelAction_F0Ok51
                  input:
                    binding:
                      Text_20input: =System.Activity.Text

                  output:
                    binding:
                      predictionOutput: Topic.sourceLanguageCode

                  aIModelId: 3f3b6cb6-8dd9-4818-83ea-f050b101334a

                - kind: SetVariable
                  id: setVariable_7fCiRf
                  variable: Topic.DetectedLang
                  value: =Upper(Topic.sourceLanguageCode.structuredOutput.language_code)

                - kind: SetVariable
                  id: setVariable_CleanedUserLangs
                  variable: Topic.cleanedUserLangs
                  value: =Substitute(Global.userLanguages, " ", "")

                - kind: SetVariable
                  id: setVariable_FilteredLangs
                  variable: Topic.targetLanguagesList
                  value: =Filter(Split(Topic.cleanedUserLangs, ","), Upper(Value) <> Topic.DetectedLang && !IsBlank(Value))

                - kind: SetVariable
                  id: setVariable_CountLangs
                  variable: Topic.targetLangCount
                  value: =CountRows(Topic.targetLanguagesList)

                - kind: ConditionGroup
                  id: conditionGroup_CheckLangCount
                  conditions:
                    - id: conditionItem_IfTwoOrMoreLangs
                      condition: =Topic.targetLangCount >= 2
                      actions:
                        - kind: SetVariable
                          id: setVariable_GetLang1_two
                          variable: Topic.Lang1
                          value: =First(Topic.targetLanguagesList).Value

                        - kind: SetVariable
                          id: setVariable_GetLang2_two
                          variable: Topic.Lang2
                          value: =Last(FirstN(Topic.targetLanguagesList, 2)).Value

                        - kind: InvokeAIBuilderModelAction
                          id: invokeAIBuilderModelAction_89uUAa_two
                          input:
                            binding:
                              langCode: =Topic.Lang1
                              textToTranslate: =System.Activity.Text

                          output:
                            binding:
                              predictionOutput: Topic.Translation1

                          aIModelId: 78bd35b1-ae2f-4a97-bbcd-d0c8353abf5c

                        - kind: InvokeAIBuilderModelAction
                          id: invokeAIBuilderModelAction_wcLw4j_two
                          input:
                            binding:
                              langCode: =Topic.Lang2
                              textToTranslate: =System.Activity.Text

                          output:
                            binding:
                              predictionOutput: Topic.Translation2

                          aIModelId: 78bd35b1-ae2f-4a97-bbcd-d0c8353abf5c

                        - kind: SendActivity
                          id: sendActivity_rRD339_two
                          activity: |-
                            {Topic.Lang1}: {Topic.Translation1.text}
                            {Topic.Lang2}: {Topic.Translation2.text}

                    - id: conditionItem_IfOneLang
                      condition: =Topic.targetLangCount = 1
                      actions:
                        - kind: SetVariable
                          id: setVariable_GetLang1_one
                          variable: Topic.Lang1
                          value: =First(Topic.targetLanguagesList).Value

                        - kind: InvokeAIBuilderModelAction
                          id: invokeAIBuilderModelAction_89uUAa_one
                          input:
                            binding:
                              langCode: =Topic.Lang1
                              textToTranslate: =System.Activity.Text

                          output:
                            binding:
                              predictionOutput: Topic.Translation1

                          aIModelId: 78bd35b1-ae2f-4a97-bbcd-d0c8353abf5c

                        - kind: SendActivity
                          id: sendActivity_rRD339_one
                          activity: "{Topic.Lang1}: {Topic.Translation1.text}"

    - kind: EndDialog
      id: endDialog_main

inputType: {}
outputType: {}